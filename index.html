<!DOCTYPE html>
<html>
<body style="margin:0;overflow:hidden;background:#222">

<canvas id="c" width="800" height="600"></canvas>
<script>
const c = document.getElementById("c");
const ctx = c.getContext("2d");

let x = 400, y = 300;
let others = [];

const ws = new WebSocket("https://slips-2.onrender.com");
// if deployed use: wss://yourapp.onrender.com

ws.onmessage = e => {
    const data = JSON.parse(e.data);
    others = data.players;
};

let keys = {};
document.onkeydown = e => keys[e.key] = true;
document.onkeyup   = e => delete keys[e.key];

function loop() {
    if (keys["w"]) y -= 4;
    if (keys["s"]) y += 4;
    if (keys["a"]) x -= 4;
    if (keys["d"]) x += 4;

    if (ws.readyState === 1)
        ws.send(JSON.stringify({x, y}));

    ctx.clearRect(0,0,800,600);

    // draw me (first player)
    ctx.fillStyle = "cyan";
    ctx.fillRect(x-10,y-10,20,20);

    // draw others
    ctx.fillStyle = "red";
    others.forEach(p=>{
        if (p.x !== x || p.y !== y)
            ctx.fillRect(p.x-10, p.y-10, 20, 20);
    });

    requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>

